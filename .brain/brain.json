{
    "meta": {
        "schema_version": "1.1.0",
        "awf_version": "4.0.0",
        "last_updated": "2026-03-01T16:32:00+09:00"
    },
    "project": {
        "name": "DocStudio",
        "type": "web-app",
        "status": "active",
        "description": "Bộ công cụ xử lý tài liệu: tạo PO từ prompt AI, xử lý PDF, chỉnh sửa hình ảnh, tạo HTML builder, match file Excel",
        "repo": "https://github.com/bangluutru/docstudio.git",
        "deploy": "Cloudflare Pages"
    },
    "tech_stack": {
        "frontend": {
            "framework": "React 19",
            "bundler": "Vite 7.3",
            "styling": "Vanilla CSS + Inline styles",
            "icons": "lucide-react"
        },
        "libraries": {
            "excel": [
                "exceljs (read/write xlsx)",
                "xlsx (SheetJS - parsing)"
            ],
            "pdf": [
                "pdf-lib (create/edit PDF)",
                "pdfjs-dist (render PDF)"
            ],
            "drag_drop": [
                "@dnd-kit/core",
                "@dnd-kit/sortable"
            ],
            "other": [
                "react-dom",
                "react-colorful"
            ]
        },
        "deployment": {
            "hosting": "Cloudflare Pages",
            "ci_cd": "GitHub → Cloudflare auto-deploy on push to main"
        }
    },
    "architecture": {
        "tabs": [
            {
                "id": 1,
                "name": "PO Generator",
                "file": "src/components/ExcelCreatorView.jsx",
                "status": "stable"
            },
            {
                "id": 2,
                "name": "PDF Toolkit",
                "file": "src/components/PdfToolkitView.jsx",
                "status": "stable"
            },
            {
                "id": 3,
                "name": "Image Editor",
                "file": "src/components/ImageEditorView.jsx",
                "status": "stable"
            },
            {
                "id": 4,
                "name": "Doc Overlay",
                "file": "src/components/DocOverlayView.jsx",
                "status": "stable"
            },
            {
                "id": 5,
                "name": "HTML Builder",
                "file": "src/components/HtmlBuilderView.jsx",
                "status": "stable"
            },
            {
                "id": 6,
                "name": "Excel Mapping",
                "file": "src/components/ExcelMappingView.jsx",
                "status": "active-development"
            }
        ],
        "key_files": {
            "app_entry": "src/App.jsx",
            "excel_utils": "src/utils/excel.js",
            "zone_editor": "src/components/ZoneEditor.jsx",
            "styles": "src/index.css"
        }
    },
    "features": {
        "tab6_excel_mapping": {
            "description": "Upload file đơn hàng khách + mẫu NCC → auto-map fields → xuất file Excel theo mẫu NCC",
            "architecture": {
                "3_zone_model": "Header zone | Data zone | Footer zone",
                "zone_editor": "ZoneEditor.jsx - standalone component",
                "export_engine": "ExcelJS engine: Save→Unmerge→Splice→Clear→Write→Re-merge LAST"
            },
            "resolved_issues": [
                "ZoneEditor auto-collapse → tách file riêng",
                "Date picker → ISO format",
                "Merge cell vỡ → reorder operations",
                "xlsx-template crash → Node.js-only, đã gỡ"
            ]
        }
    },
    "knowledge_items": {
        "patterns": [
            "ExcelJS merge: unmerge TRƯỚC spliceRows, re-merge SAU write data",
            "React component identity: inline definition → remount → mất state",
            "Vite: Node.js-only libs crash runtime trong browser"
        ],
        "gotchas": [
            "xlsx-template KHÔNG chạy trong browser",
            "ExcelJS sharedFormula corrupt sau spliceRows",
            "ExcelJS ws._merges vs ws.model.merges: check cả 2"
        ]
    }
}